Clearing CUDA cache...
CUDA cache cleared.
Created directory: ./work_dir/MedSAM-ViT-B_MSFalse_oneneckFalse_use_clip_20250617-1643
[liver]  cases: 40, slices: 2522
[right_kidney]  cases: 40, slices: 1619
[spleen]  cases: 40, slices: 1310
[pancreas]  cases: 40, slices: 1274
[aorta]  cases: 40, slices: 3486
[ivc]  cases: 40, slices: 3226
[right_adrenal_gland]  cases: 40, slices: 449
[left_adrenal_gland]  cases: 40, slices: 534
[gallbladder]  cases: 40, slices: 686
[esophagus]  cases: 40, slices: 1074
[stomach]  cases: 40, slices: 1557
[left_kidney]  cases: 40, slices: 1650
Checkpoint loaded successfully. Starting from epoch 1.
Using wandb
Liver Validation Complete: Loss: 0.1665, Dice: 0.8653
Right_kidney Validation Complete: Loss: 0.0321, Dice: 0.9631
Spleen Validation Complete: Loss: 0.0472, Dice: 0.9544
Pancreas Validation Complete: Loss: 0.2107, Dice: 0.7437
Aorta Validation Complete: Loss: 0.0427, Dice: 0.9468
Ivc Validation Complete: Loss: 0.0648, Dice: 0.9245
Right_adrenal_gland Validation Complete: Loss: 0.1917, Dice: 0.7652
Left_adrenal_gland Validation Complete: Loss: 0.1549, Dice: 0.8089
Gallbladder Validation Complete: Loss: 0.1072, Dice: 0.8870
Esophagus Validation Complete: Loss: 0.1046, Dice: 0.8619
Stomach Validation Complete: Loss: 0.0690, Dice: 0.9314
Left_kidney Validation Complete: Loss: 0.0277, Dice: 0.9690
Time: 20250617-1732, train_Loss: 0.05818567778704265, train_accuracy : 0.9322474419446833
Epoch 2/100
saved a better ckpt.
val loss: 0.10157751546347103
  Liver - Val Loss: 0.1665, Dice: 0.8653
  Right_kidney - Val Loss: 0.0321, Dice: 0.9631
  Spleen - Val Loss: 0.0472, Dice: 0.9544
  Pancreas - Val Loss: 0.2107, Dice: 0.7437
  Aorta - Val Loss: 0.0427, Dice: 0.9468
  Ivc - Val Loss: 0.0648, Dice: 0.9245
  Right_adrenal_gland - Val Loss: 0.1917, Dice: 0.7652
  Left_adrenal_gland - Val Loss: 0.1549, Dice: 0.8089
  Gallbladder - Val Loss: 0.1072, Dice: 0.8870
  Esophagus - Val Loss: 0.1046, Dice: 0.8619
  Stomach - Val Loss: 0.0690, Dice: 0.9314
  Left_kidney - Val Loss: 0.0277, Dice: 0.9690
Liver Validation Complete: Loss: 0.1111, Dice: 0.8917
Right_kidney Validation Complete: Loss: 0.0310, Dice: 0.9637
Spleen Validation Complete: Loss: 0.0390, Dice: 0.9674
Pancreas Validation Complete: Loss: 0.2129, Dice: 0.7378
Aorta Validation Complete: Loss: 0.0417, Dice: 0.9488
Ivc Validation Complete: Loss: 0.0689, Dice: 0.9218
Right_adrenal_gland Validation Complete: Loss: 0.1256, Dice: 0.8346
Left_adrenal_gland Validation Complete: Loss: 0.1400, Dice: 0.8323
Gallbladder Validation Complete: Loss: 0.0772, Dice: 0.9233
Esophagus Validation Complete: Loss: 0.0844, Dice: 0.8877
Stomach Validation Complete: Loss: 0.0548, Dice: 0.9431
Left_kidney Validation Complete: Loss: 0.0268, Dice: 0.9691
Time: 20250617-1822, train_Loss: 0.04908627057874626, train_accuracy : 0.9425883505729217
Epoch 3/100
saved a better ckpt.
val loss: 0.08444853635999901
  Liver - Val Loss: 0.1111, Dice: 0.8917
  Right_kidney - Val Loss: 0.0310, Dice: 0.9637
  Spleen - Val Loss: 0.0390, Dice: 0.9674
  Pancreas - Val Loss: 0.2129, Dice: 0.7378
  Aorta - Val Loss: 0.0417, Dice: 0.9488
  Ivc - Val Loss: 0.0689, Dice: 0.9218
  Right_adrenal_gland - Val Loss: 0.1256, Dice: 0.8346
  Left_adrenal_gland - Val Loss: 0.1400, Dice: 0.8323
  Gallbladder - Val Loss: 0.0772, Dice: 0.9233
  Esophagus - Val Loss: 0.0844, Dice: 0.8877
  Stomach - Val Loss: 0.0548, Dice: 0.9431
  Left_kidney - Val Loss: 0.0268, Dice: 0.9691
Liver Validation Complete: Loss: 0.0766, Dice: 0.9406
Right_kidney Validation Complete: Loss: 0.0313, Dice: 0.9622
Spleen Validation Complete: Loss: 0.0356, Dice: 0.9677
Pancreas Validation Complete: Loss: 0.1852, Dice: 0.7708
Aorta Validation Complete: Loss: 0.0363, Dice: 0.9530
Ivc Validation Complete: Loss: 0.0660, Dice: 0.9175
Right_adrenal_gland Validation Complete: Loss: 0.1499, Dice: 0.8104
Left_adrenal_gland Validation Complete: Loss: 0.1306, Dice: 0.8304
Gallbladder Validation Complete: Loss: 0.0883, Dice: 0.9091
Esophagus Validation Complete: Loss: 0.0924, Dice: 0.8697
Stomach Validation Complete: Loss: 0.0550, Dice: 0.9442
Left_kidney Validation Complete: Loss: 0.0259, Dice: 0.9710
Time: 20250617-1911, train_Loss: 0.043567477762354014, train_accuracy : 0.9491762857329835
Epoch 4/100
saved a better ckpt.
val loss: 0.08108799229862118
  Liver - Val Loss: 0.0766, Dice: 0.9406
  Right_kidney - Val Loss: 0.0313, Dice: 0.9622
  Spleen - Val Loss: 0.0356, Dice: 0.9677
  Pancreas - Val Loss: 0.1852, Dice: 0.7708
  Aorta - Val Loss: 0.0363, Dice: 0.9530
  Ivc - Val Loss: 0.0660, Dice: 0.9175
  Right_adrenal_gland - Val Loss: 0.1499, Dice: 0.8104
  Left_adrenal_gland - Val Loss: 0.1306, Dice: 0.8304
  Gallbladder - Val Loss: 0.0883, Dice: 0.9091
  Esophagus - Val Loss: 0.0924, Dice: 0.8697
  Stomach - Val Loss: 0.0550, Dice: 0.9442
  Left_kidney - Val Loss: 0.0259, Dice: 0.9710
Liver Validation Complete: Loss: 0.0878, Dice: 0.9341
Right_kidney Validation Complete: Loss: 0.0283, Dice: 0.9680
Spleen Validation Complete: Loss: 0.0394, Dice: 0.9669
Pancreas Validation Complete: Loss: 0.1875, Dice: 0.7799
Aorta Validation Complete: Loss: 0.0355, Dice: 0.9552
Ivc Validation Complete: Loss: 0.0721, Dice: 0.9259
Right_adrenal_gland Validation Complete: Loss: 0.1275, Dice: 0.8319
Left_adrenal_gland Validation Complete: Loss: 0.1278, Dice: 0.8387
Gallbladder Validation Complete: Loss: 0.0809, Dice: 0.9244
Esophagus Validation Complete: Loss: 0.0915, Dice: 0.8793
Stomach Validation Complete: Loss: 0.0497, Dice: 0.9513
Left_kidney Validation Complete: Loss: 0.0249, Dice: 0.9730
Time: 20250617-2000, train_Loss: 0.0407770383528832, train_accuracy : 0.9524140115773142
Epoch 5/100
saved a better ckpt.
val loss: 0.07940883525125961
  Liver - Val Loss: 0.0878, Dice: 0.9341
  Right_kidney - Val Loss: 0.0283, Dice: 0.9680
  Spleen - Val Loss: 0.0394, Dice: 0.9669
  Pancreas - Val Loss: 0.1875, Dice: 0.7799
  Aorta - Val Loss: 0.0355, Dice: 0.9552
  Ivc - Val Loss: 0.0721, Dice: 0.9259
  Right_adrenal_gland - Val Loss: 0.1275, Dice: 0.8319
  Left_adrenal_gland - Val Loss: 0.1278, Dice: 0.8387
  Gallbladder - Val Loss: 0.0809, Dice: 0.9244
  Esophagus - Val Loss: 0.0915, Dice: 0.8793
  Stomach - Val Loss: 0.0497, Dice: 0.9513
  Left_kidney - Val Loss: 0.0249, Dice: 0.9730
Liver Validation Complete: Loss: 0.0708, Dice: 0.9507
