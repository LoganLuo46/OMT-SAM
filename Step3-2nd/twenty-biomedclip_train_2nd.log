No prompt file specified, using organ names as prompts
Clearing CUDA cache...
CUDA cache cleared.
Created directory: ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608
[MedSAM] clip_variant: biomedclip, clip_model_name: hf-hub:microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224
[INFO] clip_variant: biomedclip, tokenizer: microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: liver, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[liver]  cases: 40, slices: 2522
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: right_kidney, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[right_kidney]  cases: 40, slices: 1619
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: spleen, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[spleen]  cases: 40, slices: 1310
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: pancreas, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[pancreas]  cases: 40, slices: 1274
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: aorta, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[aorta]  cases: 40, slices: 3486
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: ivc, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[ivc]  cases: 40, slices: 3226
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: right_adrenal_gland, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[right_adrenal_gland]  cases: 40, slices: 449
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: left_adrenal_gland, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[left_adrenal_gland]  cases: 40, slices: 534
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: gallbladder, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[gallbladder]  cases: 40, slices: 686
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: esophagus, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[esophagus]  cases: 40, slices: 1074
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: stomach, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[stomach]  cases: 40, slices: 1557
Loaded prompts from organ_prompts_twenty.txt
[OrganSliceDataset] organ: left_kidney, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_twenty.txt
[left_kidney]  cases: 40, slices: 1650
Checkpoint loaded successfully. Starting from epoch 1.
Using wandb
Liver Validation Complete: Loss: 0.2334, Dice: 0.7809
Right_kidney Validation Complete: Loss: 0.0336, Dice: 0.9618
Spleen Validation Complete: Loss: 0.0523, Dice: 0.9521
Pancreas Validation Complete: Loss: 0.2192, Dice: 0.7364
Aorta Validation Complete: Loss: 0.0467, Dice: 0.9434
Ivc Validation Complete: Loss: 0.0710, Dice: 0.9196
Right_adrenal_gland Validation Complete: Loss: 0.2268, Dice: 0.7117
Left_adrenal_gland Validation Complete: Loss: 0.1544, Dice: 0.7963
Gallbladder Validation Complete: Loss: 0.1197, Dice: 0.8696
Esophagus Validation Complete: Loss: 0.1406, Dice: 0.8273
Stomach Validation Complete: Loss: 0.0731, Dice: 0.9242
Left_kidney Validation Complete: Loss: 0.0289, Dice: 0.9677
Time: 20250620-1756, train_Loss: 0.05758932537274129, train_accuracy : 0.9329652157447547
Epoch 2/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.1166382892731236
  Liver - Val Loss: 0.2334, Dice: 0.7809
  Right_kidney - Val Loss: 0.0336, Dice: 0.9618
  Spleen - Val Loss: 0.0523, Dice: 0.9521
  Pancreas - Val Loss: 0.2192, Dice: 0.7364
  Aorta - Val Loss: 0.0467, Dice: 0.9434
  Ivc - Val Loss: 0.0710, Dice: 0.9196
  Right_adrenal_gland - Val Loss: 0.2268, Dice: 0.7117
  Left_adrenal_gland - Val Loss: 0.1544, Dice: 0.7963
  Gallbladder - Val Loss: 0.1197, Dice: 0.8696
  Esophagus - Val Loss: 0.1406, Dice: 0.8273
  Stomach - Val Loss: 0.0731, Dice: 0.9242
  Left_kidney - Val Loss: 0.0289, Dice: 0.9677
Liver Validation Complete: Loss: 0.1211, Dice: 0.8942
Right_kidney Validation Complete: Loss: 0.0366, Dice: 0.9499
Spleen Validation Complete: Loss: 0.0443, Dice: 0.9597
Pancreas Validation Complete: Loss: 0.2124, Dice: 0.7415
Aorta Validation Complete: Loss: 0.0378, Dice: 0.9510
Ivc Validation Complete: Loss: 0.0584, Dice: 0.9329
Right_adrenal_gland Validation Complete: Loss: 0.1463, Dice: 0.8050
Left_adrenal_gland Validation Complete: Loss: 0.1315, Dice: 0.8296
Gallbladder Validation Complete: Loss: 0.0846, Dice: 0.9123
Esophagus Validation Complete: Loss: 0.1209, Dice: 0.8380
Stomach Validation Complete: Loss: 0.0615, Dice: 0.9404
Left_kidney Validation Complete: Loss: 0.0276, Dice: 0.9694
Time: 20250620-1846, train_Loss: 0.049906335918714996, train_accuracy : 0.9416123034425011
Epoch 3/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.09024952362472287
  Liver - Val Loss: 0.1211, Dice: 0.8942
  Right_kidney - Val Loss: 0.0366, Dice: 0.9499
  Spleen - Val Loss: 0.0443, Dice: 0.9597
  Pancreas - Val Loss: 0.2124, Dice: 0.7415
  Aorta - Val Loss: 0.0378, Dice: 0.9510
  Ivc - Val Loss: 0.0584, Dice: 0.9329
  Right_adrenal_gland - Val Loss: 0.1463, Dice: 0.8050
  Left_adrenal_gland - Val Loss: 0.1315, Dice: 0.8296
  Gallbladder - Val Loss: 0.0846, Dice: 0.9123
  Esophagus - Val Loss: 0.1209, Dice: 0.8380
  Stomach - Val Loss: 0.0615, Dice: 0.9404
  Left_kidney - Val Loss: 0.0276, Dice: 0.9694
Liver Validation Complete: Loss: 0.0715, Dice: 0.9460
Right_kidney Validation Complete: Loss: 0.0285, Dice: 0.9663
Spleen Validation Complete: Loss: 0.0413, Dice: 0.9617
Pancreas Validation Complete: Loss: 0.1969, Dice: 0.7598
Aorta Validation Complete: Loss: 0.0345, Dice: 0.9565
Ivc Validation Complete: Loss: 0.0530, Dice: 0.9373
Right_adrenal_gland Validation Complete: Loss: 0.1282, Dice: 0.8304
Left_adrenal_gland Validation Complete: Loss: 0.1054, Dice: 0.8617
Gallbladder Validation Complete: Loss: 0.0691, Dice: 0.9278
Esophagus Validation Complete: Loss: 0.1035, Dice: 0.8608
Stomach Validation Complete: Loss: 0.0578, Dice: 0.9420
Left_kidney Validation Complete: Loss: 0.0265, Dice: 0.9701
Time: 20250620-1935, train_Loss: 0.04378279772593352, train_accuracy : 0.9487875270112606
Epoch 4/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.07634846127546051
  Liver - Val Loss: 0.0715, Dice: 0.9460
  Right_kidney - Val Loss: 0.0285, Dice: 0.9663
  Spleen - Val Loss: 0.0413, Dice: 0.9617
  Pancreas - Val Loss: 0.1969, Dice: 0.7598
  Aorta - Val Loss: 0.0345, Dice: 0.9565
  Ivc - Val Loss: 0.0530, Dice: 0.9373
  Right_adrenal_gland - Val Loss: 0.1282, Dice: 0.8304
  Left_adrenal_gland - Val Loss: 0.1054, Dice: 0.8617
  Gallbladder - Val Loss: 0.0691, Dice: 0.9278
  Esophagus - Val Loss: 0.1035, Dice: 0.8608
  Stomach - Val Loss: 0.0578, Dice: 0.9420
  Left_kidney - Val Loss: 0.0265, Dice: 0.9701
Liver Validation Complete: Loss: 0.0921, Dice: 0.9358
Right_kidney Validation Complete: Loss: 0.0280, Dice: 0.9690
Spleen Validation Complete: Loss: 0.0474, Dice: 0.9569
Pancreas Validation Complete: Loss: 0.1832, Dice: 0.7879
Aorta Validation Complete: Loss: 0.0349, Dice: 0.9581
Ivc Validation Complete: Loss: 0.0580, Dice: 0.9346
Right_adrenal_gland Validation Complete: Loss: 0.1565, Dice: 0.8035
Left_adrenal_gland Validation Complete: Loss: 0.1034, Dice: 0.8696
Gallbladder Validation Complete: Loss: 0.0789, Dice: 0.9228
Esophagus Validation Complete: Loss: 0.0916, Dice: 0.8801
Stomach Validation Complete: Loss: 0.0528, Dice: 0.9537
Left_kidney Validation Complete: Loss: 0.0263, Dice: 0.9725
Time: 20250620-2025, train_Loss: 0.04118473918574545, train_accuracy : 0.9520194491059865
Epoch 5/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608/medsam_model_latest.pth
val loss: 0.07941067568166102
  Liver - Val Loss: 0.0921, Dice: 0.9358
  Right_kidney - Val Loss: 0.0280, Dice: 0.9690
  Spleen - Val Loss: 0.0474, Dice: 0.9569
  Pancreas - Val Loss: 0.1832, Dice: 0.7879
  Aorta - Val Loss: 0.0349, Dice: 0.9581
  Ivc - Val Loss: 0.0580, Dice: 0.9346
  Right_adrenal_gland - Val Loss: 0.1565, Dice: 0.8035
  Left_adrenal_gland - Val Loss: 0.1034, Dice: 0.8696
  Gallbladder - Val Loss: 0.0789, Dice: 0.9228
  Esophagus - Val Loss: 0.0916, Dice: 0.8801
  Stomach - Val Loss: 0.0528, Dice: 0.9537
  Left_kidney - Val Loss: 0.0263, Dice: 0.9725
Liver Validation Complete: Loss: 0.0881, Dice: 0.9347
Right_kidney Validation Complete: Loss: 0.0280, Dice: 0.9706
Spleen Validation Complete: Loss: 0.0357, Dice: 0.9710
Pancreas Validation Complete: Loss: 0.1692, Dice: 0.8048
Aorta Validation Complete: Loss: 0.0335, Dice: 0.9601
Ivc Validation Complete: Loss: 0.0541, Dice: 0.9408
Right_adrenal_gland Validation Complete: Loss: 0.1328, Dice: 0.8344
Left_adrenal_gland Validation Complete: Loss: 0.0980, Dice: 0.8756
Gallbladder Validation Complete: Loss: 0.0724, Dice: 0.9282
Esophagus Validation Complete: Loss: 0.0830, Dice: 0.8888
Stomach Validation Complete: Loss: 0.0522, Dice: 0.9524
Left_kidney Validation Complete: Loss: 0.0253, Dice: 0.9736
Time: 20250620-2115, train_Loss: 0.03903287293737427, train_accuracy : 0.954549038525531
Epoch 6/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.07269633144445357
  Liver - Val Loss: 0.0881, Dice: 0.9347
  Right_kidney - Val Loss: 0.0280, Dice: 0.9706
  Spleen - Val Loss: 0.0357, Dice: 0.9710
  Pancreas - Val Loss: 0.1692, Dice: 0.8048
  Aorta - Val Loss: 0.0335, Dice: 0.9601
  Ivc - Val Loss: 0.0541, Dice: 0.9408
  Right_adrenal_gland - Val Loss: 0.1328, Dice: 0.8344
  Left_adrenal_gland - Val Loss: 0.0980, Dice: 0.8756
  Gallbladder - Val Loss: 0.0724, Dice: 0.9282
  Esophagus - Val Loss: 0.0830, Dice: 0.8888
  Stomach - Val Loss: 0.0522, Dice: 0.9524
  Left_kidney - Val Loss: 0.0253, Dice: 0.9736
Liver Validation Complete: Loss: 0.0587, Dice: 0.9574
Right_kidney Validation Complete: Loss: 0.0259, Dice: 0.9715
Spleen Validation Complete: Loss: 0.0310, Dice: 0.9755
Pancreas Validation Complete: Loss: 0.1455, Dice: 0.8282
Aorta Validation Complete: Loss: 0.0328, Dice: 0.9611
Ivc Validation Complete: Loss: 0.0484, Dice: 0.9448
Right_adrenal_gland Validation Complete: Loss: 0.1084, Dice: 0.8634
Left_adrenal_gland Validation Complete: Loss: 0.0940, Dice: 0.8807
Gallbladder Validation Complete: Loss: 0.0737, Dice: 0.9272
Esophagus Validation Complete: Loss: 0.0830, Dice: 0.8909
Stomach Validation Complete: Loss: 0.0480, Dice: 0.9566
Left_kidney Validation Complete: Loss: 0.0252, Dice: 0.9735
Time: 20250620-2205, train_Loss: 0.03474737834415437, train_accuracy : 0.9598635301841296
Epoch 7/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.06453572596068279
  Liver - Val Loss: 0.0587, Dice: 0.9574
  Right_kidney - Val Loss: 0.0259, Dice: 0.9715
  Spleen - Val Loss: 0.0310, Dice: 0.9755
  Pancreas - Val Loss: 0.1455, Dice: 0.8282
  Aorta - Val Loss: 0.0328, Dice: 0.9611
  Ivc - Val Loss: 0.0484, Dice: 0.9448
  Right_adrenal_gland - Val Loss: 0.1084, Dice: 0.8634
  Left_adrenal_gland - Val Loss: 0.0940, Dice: 0.8807
  Gallbladder - Val Loss: 0.0737, Dice: 0.9272
  Esophagus - Val Loss: 0.0830, Dice: 0.8909
  Stomach - Val Loss: 0.0480, Dice: 0.9566
  Left_kidney - Val Loss: 0.0252, Dice: 0.9735
Liver Validation Complete: Loss: 0.0788, Dice: 0.9295
Right_kidney Validation Complete: Loss: 0.0252, Dice: 0.9732
Spleen Validation Complete: Loss: 0.0334, Dice: 0.9723
Pancreas Validation Complete: Loss: 0.1698, Dice: 0.7967
Aorta Validation Complete: Loss: 0.0350, Dice: 0.9591
Ivc Validation Complete: Loss: 0.0534, Dice: 0.9408
Right_adrenal_gland Validation Complete: Loss: 0.1125, Dice: 0.8609
Left_adrenal_gland Validation Complete: Loss: 0.1107, Dice: 0.8685
Gallbladder Validation Complete: Loss: 0.0717, Dice: 0.9283
Esophagus Validation Complete: Loss: 0.0866, Dice: 0.8854
Stomach Validation Complete: Loss: 0.0395, Dice: 0.9650
Left_kidney Validation Complete: Loss: 0.0250, Dice: 0.9751
Time: 20250620-2254, train_Loss: 0.03269281032784232, train_accuracy : 0.9621565236417032
Epoch 8/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_twenty_MSFalse_oneneckFalse_biomedclip_20250620-170608/medsam_model_latest.pth
val loss: 0.07013389714249378
  Liver - Val Loss: 0.0788, Dice: 0.9295
  Right_kidney - Val Loss: 0.0252, Dice: 0.9732
  Spleen - Val Loss: 0.0334, Dice: 0.9723
  Pancreas - Val Loss: 0.1698, Dice: 0.7967
  Aorta - Val Loss: 0.0350, Dice: 0.9591
  Ivc - Val Loss: 0.0534, Dice: 0.9408
  Right_adrenal_gland - Val Loss: 0.1125, Dice: 0.8609
  Left_adrenal_gland - Val Loss: 0.1107, Dice: 0.8685
  Gallbladder - Val Loss: 0.0717, Dice: 0.9283
  Esophagus - Val Loss: 0.0866, Dice: 0.8854
  Stomach - Val Loss: 0.0395, Dice: 0.9650
  Left_kidney - Val Loss: 0.0250, Dice: 0.9751
