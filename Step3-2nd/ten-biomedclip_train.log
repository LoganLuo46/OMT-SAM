No prompt file specified, using organ names as prompts
Clearing CUDA cache...
CUDA cache cleared.
Created directory: ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025
[MedSAM] clip_variant: biomedclip, clip_model_name: hf-hub:microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224
[INFO] clip_variant: biomedclip, tokenizer: microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: liver, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[liver]  cases: 40, slices: 2522
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: right_kidney, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[right_kidney]  cases: 40, slices: 1619
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: spleen, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[spleen]  cases: 40, slices: 1310
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: pancreas, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[pancreas]  cases: 40, slices: 1274
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: aorta, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[aorta]  cases: 40, slices: 3486
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: ivc, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[ivc]  cases: 40, slices: 3226
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: right_adrenal_gland, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[right_adrenal_gland]  cases: 40, slices: 449
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: left_adrenal_gland, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[left_adrenal_gland]  cases: 40, slices: 534
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: gallbladder, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[gallbladder]  cases: 40, slices: 686
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: esophagus, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[esophagus]  cases: 40, slices: 1074
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: stomach, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[stomach]  cases: 40, slices: 1557
Loaded prompts from organ_prompts_ten.txt
[OrganSliceDataset] organ: left_kidney, tokenizer: BertTokenizerFast(name_or_path='microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', vocab_size=28895, model_max_length=1000000000000000019884624838656, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True, added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
), prompt_file: organ_prompts_ten.txt
[left_kidney]  cases: 40, slices: 1650
Checkpoint loaded successfully. Starting from epoch 1.
Using wandb
Liver Validation Complete: Loss: 0.3166, Dice: 0.7174
Right_kidney Validation Complete: Loss: 0.0340, Dice: 0.9640
Spleen Validation Complete: Loss: 0.0469, Dice: 0.9560
Pancreas Validation Complete: Loss: 0.1951, Dice: 0.7707
Aorta Validation Complete: Loss: 0.0450, Dice: 0.9461
Ivc Validation Complete: Loss: 0.0829, Dice: 0.9109
Right_adrenal_gland Validation Complete: Loss: 0.1526, Dice: 0.8114
Left_adrenal_gland Validation Complete: Loss: 0.1264, Dice: 0.8412
Gallbladder Validation Complete: Loss: 0.1175, Dice: 0.8643
Esophagus Validation Complete: Loss: 0.1206, Dice: 0.8487
Stomach Validation Complete: Loss: 0.0514, Dice: 0.9495
Left_kidney Validation Complete: Loss: 0.0279, Dice: 0.9696
Time: 20250620-1750, train_Loss: 0.05587005693986974, train_accuracy : 0.934949407338032
Epoch 2/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.1097389055272955
  Liver - Val Loss: 0.3166, Dice: 0.7174
  Right_kidney - Val Loss: 0.0340, Dice: 0.9640
  Spleen - Val Loss: 0.0469, Dice: 0.9560
  Pancreas - Val Loss: 0.1951, Dice: 0.7707
  Aorta - Val Loss: 0.0450, Dice: 0.9461
  Ivc - Val Loss: 0.0829, Dice: 0.9109
  Right_adrenal_gland - Val Loss: 0.1526, Dice: 0.8114
  Left_adrenal_gland - Val Loss: 0.1264, Dice: 0.8412
  Gallbladder - Val Loss: 0.1175, Dice: 0.8643
  Esophagus - Val Loss: 0.1206, Dice: 0.8487
  Stomach - Val Loss: 0.0514, Dice: 0.9495
  Left_kidney - Val Loss: 0.0279, Dice: 0.9696
Liver Validation Complete: Loss: 0.0865, Dice: 0.9322
Right_kidney Validation Complete: Loss: 0.0302, Dice: 0.9644
Spleen Validation Complete: Loss: 0.0358, Dice: 0.9670
Pancreas Validation Complete: Loss: 0.2037, Dice: 0.7641
Aorta Validation Complete: Loss: 0.0388, Dice: 0.9528
Ivc Validation Complete: Loss: 0.0643, Dice: 0.9290
Right_adrenal_gland Validation Complete: Loss: 0.1272, Dice: 0.8338
Left_adrenal_gland Validation Complete: Loss: 0.1220, Dice: 0.8410
Gallbladder Validation Complete: Loss: 0.0762, Dice: 0.9174
Esophagus Validation Complete: Loss: 0.0955, Dice: 0.8696
Stomach Validation Complete: Loss: 0.0484, Dice: 0.9497
Left_kidney Validation Complete: Loss: 0.0258, Dice: 0.9695
Time: 20250620-1840, train_Loss: 0.05095408768865232, train_accuracy : 0.940538884051353
Epoch 3/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.07953012555507429
  Liver - Val Loss: 0.0865, Dice: 0.9322
  Right_kidney - Val Loss: 0.0302, Dice: 0.9644
  Spleen - Val Loss: 0.0358, Dice: 0.9670
  Pancreas - Val Loss: 0.2037, Dice: 0.7641
  Aorta - Val Loss: 0.0388, Dice: 0.9528
  Ivc - Val Loss: 0.0643, Dice: 0.9290
  Right_adrenal_gland - Val Loss: 0.1272, Dice: 0.8338
  Left_adrenal_gland - Val Loss: 0.1220, Dice: 0.8410
  Gallbladder - Val Loss: 0.0762, Dice: 0.9174
  Esophagus - Val Loss: 0.0955, Dice: 0.8696
  Stomach - Val Loss: 0.0484, Dice: 0.9497
  Left_kidney - Val Loss: 0.0258, Dice: 0.9695
Liver Validation Complete: Loss: 0.0723, Dice: 0.9439
Right_kidney Validation Complete: Loss: 0.0301, Dice: 0.9654
Spleen Validation Complete: Loss: 0.0391, Dice: 0.9611
Pancreas Validation Complete: Loss: 0.1890, Dice: 0.7764
Aorta Validation Complete: Loss: 0.0360, Dice: 0.9560
Ivc Validation Complete: Loss: 0.0550, Dice: 0.9374
Right_adrenal_gland Validation Complete: Loss: 0.1264, Dice: 0.8351
Left_adrenal_gland Validation Complete: Loss: 0.1081, Dice: 0.8603
Gallbladder Validation Complete: Loss: 0.0829, Dice: 0.9103
Esophagus Validation Complete: Loss: 0.0766, Dice: 0.8959
Stomach Validation Complete: Loss: 0.0442, Dice: 0.9534
Left_kidney Validation Complete: Loss: 0.0257, Dice: 0.9719
Time: 20250620-1929, train_Loss: 0.04556435417974434, train_accuracy : 0.9468932321626132
Epoch 4/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.0737886439189436
  Liver - Val Loss: 0.0723, Dice: 0.9439
  Right_kidney - Val Loss: 0.0301, Dice: 0.9654
  Spleen - Val Loss: 0.0391, Dice: 0.9611
  Pancreas - Val Loss: 0.1890, Dice: 0.7764
  Aorta - Val Loss: 0.0360, Dice: 0.9560
  Ivc - Val Loss: 0.0550, Dice: 0.9374
  Right_adrenal_gland - Val Loss: 0.1264, Dice: 0.8351
  Left_adrenal_gland - Val Loss: 0.1081, Dice: 0.8603
  Gallbladder - Val Loss: 0.0829, Dice: 0.9103
  Esophagus - Val Loss: 0.0766, Dice: 0.8959
  Stomach - Val Loss: 0.0442, Dice: 0.9534
  Left_kidney - Val Loss: 0.0257, Dice: 0.9719
Liver Validation Complete: Loss: 0.0692, Dice: 0.9515
Right_kidney Validation Complete: Loss: 0.0280, Dice: 0.9681
Spleen Validation Complete: Loss: 0.0356, Dice: 0.9649
Pancreas Validation Complete: Loss: 0.1882, Dice: 0.7888
Aorta Validation Complete: Loss: 0.0334, Dice: 0.9581
Ivc Validation Complete: Loss: 0.0577, Dice: 0.9359
Right_adrenal_gland Validation Complete: Loss: 0.1584, Dice: 0.7933
Left_adrenal_gland Validation Complete: Loss: 0.1153, Dice: 0.8439
Gallbladder Validation Complete: Loss: 0.0743, Dice: 0.9221
Esophagus Validation Complete: Loss: 0.1078, Dice: 0.8598
Stomach Validation Complete: Loss: 0.0496, Dice: 0.9503
Left_kidney Validation Complete: Loss: 0.0252, Dice: 0.9703
Time: 20250620-2019, train_Loss: 0.041245868409889384, train_accuracy : 0.9520447787217688
Epoch 5/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.07855829589537151
  Liver - Val Loss: 0.0692, Dice: 0.9515
  Right_kidney - Val Loss: 0.0280, Dice: 0.9681
  Spleen - Val Loss: 0.0356, Dice: 0.9649
  Pancreas - Val Loss: 0.1882, Dice: 0.7888
  Aorta - Val Loss: 0.0334, Dice: 0.9581
  Ivc - Val Loss: 0.0577, Dice: 0.9359
  Right_adrenal_gland - Val Loss: 0.1584, Dice: 0.7933
  Left_adrenal_gland - Val Loss: 0.1153, Dice: 0.8439
  Gallbladder - Val Loss: 0.0743, Dice: 0.9221
  Esophagus - Val Loss: 0.1078, Dice: 0.8598
  Stomach - Val Loss: 0.0496, Dice: 0.9503
  Left_kidney - Val Loss: 0.0252, Dice: 0.9703
Liver Validation Complete: Loss: 0.0745, Dice: 0.9454
Right_kidney Validation Complete: Loss: 0.0273, Dice: 0.9710
Spleen Validation Complete: Loss: 0.0393, Dice: 0.9631
Pancreas Validation Complete: Loss: 0.1972, Dice: 0.7698
Aorta Validation Complete: Loss: 0.0359, Dice: 0.9573
Ivc Validation Complete: Loss: 0.0531, Dice: 0.9375
Right_adrenal_gland Validation Complete: Loss: 0.1654, Dice: 0.7954
Left_adrenal_gland Validation Complete: Loss: 0.1477, Dice: 0.8270
Gallbladder Validation Complete: Loss: 0.0744, Dice: 0.9260
Esophagus Validation Complete: Loss: 0.0935, Dice: 0.8789
Stomach Validation Complete: Loss: 0.0563, Dice: 0.9369
Left_kidney Validation Complete: Loss: 0.0248, Dice: 0.9732
Time: 20250620-2109, train_Loss: 0.040238805978002466, train_accuracy : 0.95354075193428
Epoch 6/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.08245015445345423
  Liver - Val Loss: 0.0745, Dice: 0.9454
  Right_kidney - Val Loss: 0.0273, Dice: 0.9710
  Spleen - Val Loss: 0.0393, Dice: 0.9631
  Pancreas - Val Loss: 0.1972, Dice: 0.7698
  Aorta - Val Loss: 0.0359, Dice: 0.9573
  Ivc - Val Loss: 0.0531, Dice: 0.9375
  Right_adrenal_gland - Val Loss: 0.1654, Dice: 0.7954
  Left_adrenal_gland - Val Loss: 0.1477, Dice: 0.8270
  Gallbladder - Val Loss: 0.0744, Dice: 0.9260
  Esophagus - Val Loss: 0.0935, Dice: 0.8789
  Stomach - Val Loss: 0.0563, Dice: 0.9369
  Left_kidney - Val Loss: 0.0248, Dice: 0.9732
Liver Validation Complete: Loss: 0.0859, Dice: 0.9336
Right_kidney Validation Complete: Loss: 0.0271, Dice: 0.9706
Spleen Validation Complete: Loss: 0.0356, Dice: 0.9655
Pancreas Validation Complete: Loss: 0.1554, Dice: 0.8249
Aorta Validation Complete: Loss: 0.0346, Dice: 0.9602
Ivc Validation Complete: Loss: 0.0520, Dice: 0.9432
Right_adrenal_gland Validation Complete: Loss: 0.1358, Dice: 0.8256
Left_adrenal_gland Validation Complete: Loss: 0.1059, Dice: 0.8699
Gallbladder Validation Complete: Loss: 0.0741, Dice: 0.9260
Esophagus Validation Complete: Loss: 0.0900, Dice: 0.8858
Stomach Validation Complete: Loss: 0.0410, Dice: 0.9592
Left_kidney Validation Complete: Loss: 0.0235, Dice: 0.9747
Time: 20250620-2159, train_Loss: 0.03655937423702373, train_accuracy : 0.9575428243787935
Epoch 7/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.071735456498571
  Liver - Val Loss: 0.0859, Dice: 0.9336
  Right_kidney - Val Loss: 0.0271, Dice: 0.9706
  Spleen - Val Loss: 0.0356, Dice: 0.9655
  Pancreas - Val Loss: 0.1554, Dice: 0.8249
  Aorta - Val Loss: 0.0346, Dice: 0.9602
  Ivc - Val Loss: 0.0520, Dice: 0.9432
  Right_adrenal_gland - Val Loss: 0.1358, Dice: 0.8256
  Left_adrenal_gland - Val Loss: 0.1059, Dice: 0.8699
  Gallbladder - Val Loss: 0.0741, Dice: 0.9260
  Esophagus - Val Loss: 0.0900, Dice: 0.8858
  Stomach - Val Loss: 0.0410, Dice: 0.9592
  Left_kidney - Val Loss: 0.0235, Dice: 0.9747
Liver Validation Complete: Loss: 0.0651, Dice: 0.9541
Right_kidney Validation Complete: Loss: 0.0273, Dice: 0.9700
Spleen Validation Complete: Loss: 0.0324, Dice: 0.9719
Pancreas Validation Complete: Loss: 0.1505, Dice: 0.8258
Aorta Validation Complete: Loss: 0.0345, Dice: 0.9611
Ivc Validation Complete: Loss: 0.0553, Dice: 0.9400
Right_adrenal_gland Validation Complete: Loss: 0.1125, Dice: 0.8613
Left_adrenal_gland Validation Complete: Loss: 0.1054, Dice: 0.8754
Gallbladder Validation Complete: Loss: 0.0725, Dice: 0.9301
Esophagus Validation Complete: Loss: 0.0751, Dice: 0.9068
Stomach Validation Complete: Loss: 0.0349, Dice: 0.9670
Left_kidney Validation Complete: Loss: 0.0232, Dice: 0.9743
Time: 20250620-2249, train_Loss: 0.03519093671289229, train_accuracy : 0.9594572178006031
Epoch 8/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.06572595354629496
  Liver - Val Loss: 0.0651, Dice: 0.9541
  Right_kidney - Val Loss: 0.0273, Dice: 0.9700
  Spleen - Val Loss: 0.0324, Dice: 0.9719
  Pancreas - Val Loss: 0.1505, Dice: 0.8258
  Aorta - Val Loss: 0.0345, Dice: 0.9611
  Ivc - Val Loss: 0.0553, Dice: 0.9400
  Right_adrenal_gland - Val Loss: 0.1125, Dice: 0.8613
  Left_adrenal_gland - Val Loss: 0.1054, Dice: 0.8754
  Gallbladder - Val Loss: 0.0725, Dice: 0.9301
  Esophagus - Val Loss: 0.0751, Dice: 0.9068
  Stomach - Val Loss: 0.0349, Dice: 0.9670
  Left_kidney - Val Loss: 0.0232, Dice: 0.9743
Liver Validation Complete: Loss: 0.1021, Dice: 0.9223
Right_kidney Validation Complete: Loss: 0.0273, Dice: 0.9704
Spleen Validation Complete: Loss: 0.0257, Dice: 0.9773
Pancreas Validation Complete: Loss: 0.1509, Dice: 0.8313
Aorta Validation Complete: Loss: 0.0300, Dice: 0.9645
Ivc Validation Complete: Loss: 0.0440, Dice: 0.9504
Right_adrenal_gland Validation Complete: Loss: 0.1286, Dice: 0.8374
Left_adrenal_gland Validation Complete: Loss: 0.0955, Dice: 0.8787
Gallbladder Validation Complete: Loss: 0.0715, Dice: 0.9237
Esophagus Validation Complete: Loss: 0.0839, Dice: 0.8938
Stomach Validation Complete: Loss: 0.0360, Dice: 0.9634
Left_kidney Validation Complete: Loss: 0.0228, Dice: 0.9751
Time: 20250620-2339, train_Loss: 0.03226697771238164, train_accuracy : 0.9629394274784394
Epoch 9/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.0681973518881609
  Liver - Val Loss: 0.1021, Dice: 0.9223
  Right_kidney - Val Loss: 0.0273, Dice: 0.9704
  Spleen - Val Loss: 0.0257, Dice: 0.9773
  Pancreas - Val Loss: 0.1509, Dice: 0.8313
  Aorta - Val Loss: 0.0300, Dice: 0.9645
  Ivc - Val Loss: 0.0440, Dice: 0.9504
  Right_adrenal_gland - Val Loss: 0.1286, Dice: 0.8374
  Left_adrenal_gland - Val Loss: 0.0955, Dice: 0.8787
  Gallbladder - Val Loss: 0.0715, Dice: 0.9237
  Esophagus - Val Loss: 0.0839, Dice: 0.8938
  Stomach - Val Loss: 0.0360, Dice: 0.9634
  Left_kidney - Val Loss: 0.0228, Dice: 0.9751
Liver Validation Complete: Loss: 0.0713, Dice: 0.9411
Right_kidney Validation Complete: Loss: 0.0269, Dice: 0.9712
Spleen Validation Complete: Loss: 0.0249, Dice: 0.9794
Pancreas Validation Complete: Loss: 0.1900, Dice: 0.7816
Aorta Validation Complete: Loss: 0.0322, Dice: 0.9633
Ivc Validation Complete: Loss: 0.0534, Dice: 0.9424
Right_adrenal_gland Validation Complete: Loss: 0.1278, Dice: 0.8467
Left_adrenal_gland Validation Complete: Loss: 0.1000, Dice: 0.8812
Gallbladder Validation Complete: Loss: 0.0591, Dice: 0.9408
Esophagus Validation Complete: Loss: 0.0727, Dice: 0.9066
Stomach Validation Complete: Loss: 0.0333, Dice: 0.9671
Left_kidney Validation Complete: Loss: 0.0224, Dice: 0.9752
Time: 20250621-0029, train_Loss: 0.032420943196857184, train_accuracy : 0.9628118985460501
Epoch 10/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.06783342784974551
  Liver - Val Loss: 0.0713, Dice: 0.9411
  Right_kidney - Val Loss: 0.0269, Dice: 0.9712
  Spleen - Val Loss: 0.0249, Dice: 0.9794
  Pancreas - Val Loss: 0.1900, Dice: 0.7816
  Aorta - Val Loss: 0.0322, Dice: 0.9633
  Ivc - Val Loss: 0.0534, Dice: 0.9424
  Right_adrenal_gland - Val Loss: 0.1278, Dice: 0.8467
  Left_adrenal_gland - Val Loss: 0.1000, Dice: 0.8812
  Gallbladder - Val Loss: 0.0591, Dice: 0.9408
  Esophagus - Val Loss: 0.0727, Dice: 0.9066
  Stomach - Val Loss: 0.0333, Dice: 0.9671
  Left_kidney - Val Loss: 0.0224, Dice: 0.9752
Liver Validation Complete: Loss: 0.0552, Dice: 0.9621
Right_kidney Validation Complete: Loss: 0.0270, Dice: 0.9712
Spleen Validation Complete: Loss: 0.0277, Dice: 0.9770
Pancreas Validation Complete: Loss: 0.1337, Dice: 0.8496
Aorta Validation Complete: Loss: 0.0313, Dice: 0.9642
Ivc Validation Complete: Loss: 0.0461, Dice: 0.9489
Right_adrenal_gland Validation Complete: Loss: 0.1158, Dice: 0.8610
Left_adrenal_gland Validation Complete: Loss: 0.0893, Dice: 0.8911
Gallbladder Validation Complete: Loss: 0.0598, Dice: 0.9397
Esophagus Validation Complete: Loss: 0.0724, Dice: 0.9109
Stomach Validation Complete: Loss: 0.0327, Dice: 0.9683
Left_kidney Validation Complete: Loss: 0.0227, Dice: 0.9760
Time: 20250621-0120, train_Loss: 0.029460735194868207, train_accuracy : 0.9663095673761881
Epoch 11/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.059471806628744614
  Liver - Val Loss: 0.0552, Dice: 0.9621
  Right_kidney - Val Loss: 0.0270, Dice: 0.9712
  Spleen - Val Loss: 0.0277, Dice: 0.9770
  Pancreas - Val Loss: 0.1337, Dice: 0.8496
  Aorta - Val Loss: 0.0313, Dice: 0.9642
  Ivc - Val Loss: 0.0461, Dice: 0.9489
  Right_adrenal_gland - Val Loss: 0.1158, Dice: 0.8610
  Left_adrenal_gland - Val Loss: 0.0893, Dice: 0.8911
  Gallbladder - Val Loss: 0.0598, Dice: 0.9397
  Esophagus - Val Loss: 0.0724, Dice: 0.9109
  Stomach - Val Loss: 0.0327, Dice: 0.9683
  Left_kidney - Val Loss: 0.0227, Dice: 0.9760
Liver Validation Complete: Loss: 0.0396, Dice: 0.9740
Right_kidney Validation Complete: Loss: 0.0261, Dice: 0.9720
Spleen Validation Complete: Loss: 0.0232, Dice: 0.9805
Pancreas Validation Complete: Loss: 0.1299, Dice: 0.8491
Aorta Validation Complete: Loss: 0.0308, Dice: 0.9631
Ivc Validation Complete: Loss: 0.0432, Dice: 0.9509
Right_adrenal_gland Validation Complete: Loss: 0.1237, Dice: 0.8525
Left_adrenal_gland Validation Complete: Loss: 0.1020, Dice: 0.8757
Gallbladder Validation Complete: Loss: 0.0680, Dice: 0.9373
Esophagus Validation Complete: Loss: 0.0811, Dice: 0.8997
Stomach Validation Complete: Loss: 0.0323, Dice: 0.9671
Left_kidney Validation Complete: Loss: 0.0233, Dice: 0.9741
Time: 20250621-0210, train_Loss: 0.026844808966979744, train_accuracy : 0.9690090483117411
Epoch 12/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.06027663305741085
  Liver - Val Loss: 0.0396, Dice: 0.9740
  Right_kidney - Val Loss: 0.0261, Dice: 0.9720
  Spleen - Val Loss: 0.0232, Dice: 0.9805
  Pancreas - Val Loss: 0.1299, Dice: 0.8491
  Aorta - Val Loss: 0.0308, Dice: 0.9631
  Ivc - Val Loss: 0.0432, Dice: 0.9509
  Right_adrenal_gland - Val Loss: 0.1237, Dice: 0.8525
  Left_adrenal_gland - Val Loss: 0.1020, Dice: 0.8757
  Gallbladder - Val Loss: 0.0680, Dice: 0.9373
  Esophagus - Val Loss: 0.0811, Dice: 0.8997
  Stomach - Val Loss: 0.0323, Dice: 0.9671
  Left_kidney - Val Loss: 0.0233, Dice: 0.9741
Liver Validation Complete: Loss: 0.0505, Dice: 0.9651
Right_kidney Validation Complete: Loss: 0.0259, Dice: 0.9736
Spleen Validation Complete: Loss: 0.0251, Dice: 0.9792
Pancreas Validation Complete: Loss: 0.1204, Dice: 0.8651
Aorta Validation Complete: Loss: 0.0317, Dice: 0.9640
Ivc Validation Complete: Loss: 0.0486, Dice: 0.9471
Right_adrenal_gland Validation Complete: Loss: 0.1124, Dice: 0.8721
Left_adrenal_gland Validation Complete: Loss: 0.0984, Dice: 0.8828
Gallbladder Validation Complete: Loss: 0.0765, Dice: 0.9243
Esophagus Validation Complete: Loss: 0.0706, Dice: 0.9138
Stomach Validation Complete: Loss: 0.0348, Dice: 0.9681
Left_kidney Validation Complete: Loss: 0.0226, Dice: 0.9764
Time: 20250621-0300, train_Loss: 0.025702603906680645, train_accuracy : 0.970352870235345
Epoch 13/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.05980187680458294
  Liver - Val Loss: 0.0505, Dice: 0.9651
  Right_kidney - Val Loss: 0.0259, Dice: 0.9736
  Spleen - Val Loss: 0.0251, Dice: 0.9792
  Pancreas - Val Loss: 0.1204, Dice: 0.8651
  Aorta - Val Loss: 0.0317, Dice: 0.9640
  Ivc - Val Loss: 0.0486, Dice: 0.9471
  Right_adrenal_gland - Val Loss: 0.1124, Dice: 0.8721
  Left_adrenal_gland - Val Loss: 0.0984, Dice: 0.8828
  Gallbladder - Val Loss: 0.0765, Dice: 0.9243
  Esophagus - Val Loss: 0.0706, Dice: 0.9138
  Stomach - Val Loss: 0.0348, Dice: 0.9681
  Left_kidney - Val Loss: 0.0226, Dice: 0.9764
Liver Validation Complete: Loss: 0.0495, Dice: 0.9625
Right_kidney Validation Complete: Loss: 0.0254, Dice: 0.9739
Spleen Validation Complete: Loss: 0.0229, Dice: 0.9816
Pancreas Validation Complete: Loss: 0.1539, Dice: 0.8402
Aorta Validation Complete: Loss: 0.0358, Dice: 0.9595
Ivc Validation Complete: Loss: 0.0793, Dice: 0.9178
Right_adrenal_gland Validation Complete: Loss: 0.1130, Dice: 0.8691
Left_adrenal_gland Validation Complete: Loss: 0.0973, Dice: 0.8833
Gallbladder Validation Complete: Loss: 0.0580, Dice: 0.9459
Esophagus Validation Complete: Loss: 0.0950, Dice: 0.8925
Stomach Validation Complete: Loss: 0.0320, Dice: 0.9694
Left_kidney Validation Complete: Loss: 0.0221, Dice: 0.9766
Time: 20250621-0349, train_Loss: 0.024521347768010397, train_accuracy : 0.9716881888684339
Epoch 14/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.06534205503384934
  Liver - Val Loss: 0.0495, Dice: 0.9625
  Right_kidney - Val Loss: 0.0254, Dice: 0.9739
  Spleen - Val Loss: 0.0229, Dice: 0.9816
  Pancreas - Val Loss: 0.1539, Dice: 0.8402
  Aorta - Val Loss: 0.0358, Dice: 0.9595
  Ivc - Val Loss: 0.0793, Dice: 0.9178
  Right_adrenal_gland - Val Loss: 0.1130, Dice: 0.8691
  Left_adrenal_gland - Val Loss: 0.0973, Dice: 0.8833
  Gallbladder - Val Loss: 0.0580, Dice: 0.9459
  Esophagus - Val Loss: 0.0950, Dice: 0.8925
  Stomach - Val Loss: 0.0320, Dice: 0.9694
  Left_kidney - Val Loss: 0.0221, Dice: 0.9766
Liver Validation Complete: Loss: 0.0327, Dice: 0.9807
Right_kidney Validation Complete: Loss: 0.0254, Dice: 0.9746
Spleen Validation Complete: Loss: 0.0219, Dice: 0.9828
Pancreas Validation Complete: Loss: 0.1079, Dice: 0.8810
Aorta Validation Complete: Loss: 0.0301, Dice: 0.9665
Ivc Validation Complete: Loss: 0.0474, Dice: 0.9502
Right_adrenal_gland Validation Complete: Loss: 0.1005, Dice: 0.8874
Left_adrenal_gland Validation Complete: Loss: 0.0949, Dice: 0.8902
Gallbladder Validation Complete: Loss: 0.0634, Dice: 0.9398
Esophagus Validation Complete: Loss: 0.0683, Dice: 0.9188
Stomach Validation Complete: Loss: 0.0314, Dice: 0.9710
Left_kidney Validation Complete: Loss: 0.0220, Dice: 0.9769
Time: 20250621-0439, train_Loss: 0.022425203717386086, train_accuracy : 0.9739924488575639
Epoch 15/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
saved a better ckpt.
val loss: 0.053827345463746006
  Liver - Val Loss: 0.0327, Dice: 0.9807
  Right_kidney - Val Loss: 0.0254, Dice: 0.9746
  Spleen - Val Loss: 0.0219, Dice: 0.9828
  Pancreas - Val Loss: 0.1079, Dice: 0.8810
  Aorta - Val Loss: 0.0301, Dice: 0.9665
  Ivc - Val Loss: 0.0474, Dice: 0.9502
  Right_adrenal_gland - Val Loss: 0.1005, Dice: 0.8874
  Left_adrenal_gland - Val Loss: 0.0949, Dice: 0.8902
  Gallbladder - Val Loss: 0.0634, Dice: 0.9398
  Esophagus - Val Loss: 0.0683, Dice: 0.9188
  Stomach - Val Loss: 0.0314, Dice: 0.9710
  Left_kidney - Val Loss: 0.0220, Dice: 0.9769
Liver Validation Complete: Loss: 0.0432, Dice: 0.9665
Right_kidney Validation Complete: Loss: 0.0253, Dice: 0.9740
Spleen Validation Complete: Loss: 0.0245, Dice: 0.9807
Pancreas Validation Complete: Loss: 0.1275, Dice: 0.8539
Aorta Validation Complete: Loss: 0.0309, Dice: 0.9653
Ivc Validation Complete: Loss: 0.0470, Dice: 0.9495
Right_adrenal_gland Validation Complete: Loss: 0.1124, Dice: 0.8730
Left_adrenal_gland Validation Complete: Loss: 0.0955, Dice: 0.8899
Gallbladder Validation Complete: Loss: 0.0601, Dice: 0.9435
Esophagus Validation Complete: Loss: 0.0681, Dice: 0.9169
Stomach Validation Complete: Loss: 0.0303, Dice: 0.9719
Left_kidney Validation Complete: Loss: 0.0223, Dice: 0.9764
Time: 20250621-0528, train_Loss: 0.02198517742162696, train_accuracy : 0.9744312846008427
Epoch 16/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.057264748577215634
  Liver - Val Loss: 0.0432, Dice: 0.9665
  Right_kidney - Val Loss: 0.0253, Dice: 0.9740
  Spleen - Val Loss: 0.0245, Dice: 0.9807
  Pancreas - Val Loss: 0.1275, Dice: 0.8539
  Aorta - Val Loss: 0.0309, Dice: 0.9653
  Ivc - Val Loss: 0.0470, Dice: 0.9495
  Right_adrenal_gland - Val Loss: 0.1124, Dice: 0.8730
  Left_adrenal_gland - Val Loss: 0.0955, Dice: 0.8899
  Gallbladder - Val Loss: 0.0601, Dice: 0.9435
  Esophagus - Val Loss: 0.0681, Dice: 0.9169
  Stomach - Val Loss: 0.0303, Dice: 0.9719
  Left_kidney - Val Loss: 0.0223, Dice: 0.9764
Liver Validation Complete: Loss: 0.0368, Dice: 0.9770
Right_kidney Validation Complete: Loss: 0.0254, Dice: 0.9745
Spleen Validation Complete: Loss: 0.0256, Dice: 0.9785
Pancreas Validation Complete: Loss: 0.1289, Dice: 0.8595
Aorta Validation Complete: Loss: 0.0322, Dice: 0.9647
Ivc Validation Complete: Loss: 0.0495, Dice: 0.9481
Right_adrenal_gland Validation Complete: Loss: 0.1110, Dice: 0.8780
Left_adrenal_gland Validation Complete: Loss: 0.0954, Dice: 0.8908
Gallbladder Validation Complete: Loss: 0.0643, Dice: 0.9381
Esophagus Validation Complete: Loss: 0.0701, Dice: 0.9169
Stomach Validation Complete: Loss: 0.0312, Dice: 0.9718
Left_kidney Validation Complete: Loss: 0.0219, Dice: 0.9771
Time: 20250621-0617, train_Loss: 0.02011778247477971, train_accuracy : 0.9765699519419867
Epoch 17/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.05770511644041749
  Liver - Val Loss: 0.0368, Dice: 0.9770
  Right_kidney - Val Loss: 0.0254, Dice: 0.9745
  Spleen - Val Loss: 0.0256, Dice: 0.9785
  Pancreas - Val Loss: 0.1289, Dice: 0.8595
  Aorta - Val Loss: 0.0322, Dice: 0.9647
  Ivc - Val Loss: 0.0495, Dice: 0.9481
  Right_adrenal_gland - Val Loss: 0.1110, Dice: 0.8780
  Left_adrenal_gland - Val Loss: 0.0954, Dice: 0.8908
  Gallbladder - Val Loss: 0.0643, Dice: 0.9381
  Esophagus - Val Loss: 0.0701, Dice: 0.9169
  Stomach - Val Loss: 0.0312, Dice: 0.9718
  Left_kidney - Val Loss: 0.0219, Dice: 0.9771
Liver Validation Complete: Loss: 0.0333, Dice: 0.9779
Right_kidney Validation Complete: Loss: 0.0250, Dice: 0.9753
Spleen Validation Complete: Loss: 0.0230, Dice: 0.9817
Pancreas Validation Complete: Loss: 0.1617, Dice: 0.8129
Aorta Validation Complete: Loss: 0.0312, Dice: 0.9655
Ivc Validation Complete: Loss: 0.0457, Dice: 0.9510
Right_adrenal_gland Validation Complete: Loss: 0.1146, Dice: 0.8743
Left_adrenal_gland Validation Complete: Loss: 0.1340, Dice: 0.8474
Gallbladder Validation Complete: Loss: 0.0729, Dice: 0.9274
Esophagus Validation Complete: Loss: 0.0826, Dice: 0.9025
Stomach Validation Complete: Loss: 0.0317, Dice: 0.9711
Left_kidney Validation Complete: Loss: 0.0222, Dice: 0.9774
Time: 20250621-0706, train_Loss: 0.021275801296531387, train_accuracy : 0.9751105288436861
Epoch 18/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.0648175830806581
  Liver - Val Loss: 0.0333, Dice: 0.9779
  Right_kidney - Val Loss: 0.0250, Dice: 0.9753
  Spleen - Val Loss: 0.0230, Dice: 0.9817
  Pancreas - Val Loss: 0.1617, Dice: 0.8129
  Aorta - Val Loss: 0.0312, Dice: 0.9655
  Ivc - Val Loss: 0.0457, Dice: 0.9510
  Right_adrenal_gland - Val Loss: 0.1146, Dice: 0.8743
  Left_adrenal_gland - Val Loss: 0.1340, Dice: 0.8474
  Gallbladder - Val Loss: 0.0729, Dice: 0.9274
  Esophagus - Val Loss: 0.0826, Dice: 0.9025
  Stomach - Val Loss: 0.0317, Dice: 0.9711
  Left_kidney - Val Loss: 0.0222, Dice: 0.9774
Liver Validation Complete: Loss: 0.0356, Dice: 0.9774
Right_kidney Validation Complete: Loss: 0.0260, Dice: 0.9742
Spleen Validation Complete: Loss: 0.0237, Dice: 0.9797
Pancreas Validation Complete: Loss: 0.1789, Dice: 0.8078
Aorta Validation Complete: Loss: 0.0367, Dice: 0.9589
Ivc Validation Complete: Loss: 0.0545, Dice: 0.9412
Right_adrenal_gland Validation Complete: Loss: 0.1472, Dice: 0.8312
Left_adrenal_gland Validation Complete: Loss: 0.1556, Dice: 0.8173
Gallbladder Validation Complete: Loss: 0.0856, Dice: 0.9180
Esophagus Validation Complete: Loss: 0.0804, Dice: 0.9049
Stomach Validation Complete: Loss: 0.0340, Dice: 0.9687
Left_kidney Validation Complete: Loss: 0.0224, Dice: 0.9766
Time: 20250621-0756, train_Loss: 0.01987145398036451, train_accuracy : 0.9765653169345414
Epoch 19/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.07338621437924898
  Liver - Val Loss: 0.0356, Dice: 0.9774
  Right_kidney - Val Loss: 0.0260, Dice: 0.9742
  Spleen - Val Loss: 0.0237, Dice: 0.9797
  Pancreas - Val Loss: 0.1789, Dice: 0.8078
  Aorta - Val Loss: 0.0367, Dice: 0.9589
  Ivc - Val Loss: 0.0545, Dice: 0.9412
  Right_adrenal_gland - Val Loss: 0.1472, Dice: 0.8312
  Left_adrenal_gland - Val Loss: 0.1556, Dice: 0.8173
  Gallbladder - Val Loss: 0.0856, Dice: 0.9180
  Esophagus - Val Loss: 0.0804, Dice: 0.9049
  Stomach - Val Loss: 0.0340, Dice: 0.9687
  Left_kidney - Val Loss: 0.0224, Dice: 0.9766
Liver Validation Complete: Loss: 0.0369, Dice: 0.9733
Right_kidney Validation Complete: Loss: 0.0255, Dice: 0.9750
Spleen Validation Complete: Loss: 0.0218, Dice: 0.9829
Pancreas Validation Complete: Loss: 0.1276, Dice: 0.8598
Aorta Validation Complete: Loss: 0.0306, Dice: 0.9659
Ivc Validation Complete: Loss: 0.0498, Dice: 0.9454
Right_adrenal_gland Validation Complete: Loss: 0.1128, Dice: 0.8781
Left_adrenal_gland Validation Complete: Loss: 0.1061, Dice: 0.8768
Gallbladder Validation Complete: Loss: 0.0658, Dice: 0.9369
Esophagus Validation Complete: Loss: 0.0657, Dice: 0.9212
Stomach Validation Complete: Loss: 0.0320, Dice: 0.9719
Left_kidney Validation Complete: Loss: 0.0220, Dice: 0.9777
Time: 20250621-0845, train_Loss: 0.01751657606596707, train_accuracy : 0.9794559575759411
Epoch 20/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.05802468745159134
  Liver - Val Loss: 0.0369, Dice: 0.9733
  Right_kidney - Val Loss: 0.0255, Dice: 0.9750
  Spleen - Val Loss: 0.0218, Dice: 0.9829
  Pancreas - Val Loss: 0.1276, Dice: 0.8598
  Aorta - Val Loss: 0.0306, Dice: 0.9659
  Ivc - Val Loss: 0.0498, Dice: 0.9454
  Right_adrenal_gland - Val Loss: 0.1128, Dice: 0.8781
  Left_adrenal_gland - Val Loss: 0.1061, Dice: 0.8768
  Gallbladder - Val Loss: 0.0658, Dice: 0.9369
  Esophagus - Val Loss: 0.0657, Dice: 0.9212
  Stomach - Val Loss: 0.0320, Dice: 0.9719
  Left_kidney - Val Loss: 0.0220, Dice: 0.9777
Liver Validation Complete: Loss: 0.0279, Dice: 0.9826
Right_kidney Validation Complete: Loss: 0.0248, Dice: 0.9763
Spleen Validation Complete: Loss: 0.0235, Dice: 0.9811
Pancreas Validation Complete: Loss: 0.1178, Dice: 0.8760
Aorta Validation Complete: Loss: 0.0308, Dice: 0.9662
Ivc Validation Complete: Loss: 0.0482, Dice: 0.9487
Right_adrenal_gland Validation Complete: Loss: 0.1140, Dice: 0.8791
Left_adrenal_gland Validation Complete: Loss: 0.1086, Dice: 0.8793
Gallbladder Validation Complete: Loss: 0.0669, Dice: 0.9391
Esophagus Validation Complete: Loss: 0.0707, Dice: 0.9192
Stomach Validation Complete: Loss: 0.0306, Dice: 0.9736
Left_kidney Validation Complete: Loss: 0.0226, Dice: 0.9777
Time: 20250621-0934, train_Loss: 0.015502491473386613, train_accuracy : 0.9816379910491574
Epoch 21/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.05719667856813472
  Liver - Val Loss: 0.0279, Dice: 0.9826
  Right_kidney - Val Loss: 0.0248, Dice: 0.9763
  Spleen - Val Loss: 0.0235, Dice: 0.9811
  Pancreas - Val Loss: 0.1178, Dice: 0.8760
  Aorta - Val Loss: 0.0308, Dice: 0.9662
  Ivc - Val Loss: 0.0482, Dice: 0.9487
  Right_adrenal_gland - Val Loss: 0.1140, Dice: 0.8791
  Left_adrenal_gland - Val Loss: 0.1086, Dice: 0.8793
  Gallbladder - Val Loss: 0.0669, Dice: 0.9391
  Esophagus - Val Loss: 0.0707, Dice: 0.9192
  Stomach - Val Loss: 0.0306, Dice: 0.9736
  Left_kidney - Val Loss: 0.0226, Dice: 0.9777
Liver Validation Complete: Loss: 0.0306, Dice: 0.9817
Right_kidney Validation Complete: Loss: 0.0255, Dice: 0.9751
Spleen Validation Complete: Loss: 0.0262, Dice: 0.9778
Pancreas Validation Complete: Loss: 0.1316, Dice: 0.8614
Aorta Validation Complete: Loss: 0.0303, Dice: 0.9667
Ivc Validation Complete: Loss: 0.0442, Dice: 0.9532
Right_adrenal_gland Validation Complete: Loss: 0.1197, Dice: 0.8707
Left_adrenal_gland Validation Complete: Loss: 0.1082, Dice: 0.8749
Gallbladder Validation Complete: Loss: 0.0623, Dice: 0.9414
Esophagus Validation Complete: Loss: 0.0736, Dice: 0.9152
Stomach Validation Complete: Loss: 0.0315, Dice: 0.9734
Left_kidney Validation Complete: Loss: 0.0228, Dice: 0.9765
Time: 20250621-1024, train_Loss: 0.015501325977347864, train_accuracy : 0.9816389554895798
Epoch 22/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.05887517309339334
  Liver - Val Loss: 0.0306, Dice: 0.9817
  Right_kidney - Val Loss: 0.0255, Dice: 0.9751
  Spleen - Val Loss: 0.0262, Dice: 0.9778
  Pancreas - Val Loss: 0.1316, Dice: 0.8614
  Aorta - Val Loss: 0.0303, Dice: 0.9667
  Ivc - Val Loss: 0.0442, Dice: 0.9532
  Right_adrenal_gland - Val Loss: 0.1197, Dice: 0.8707
  Left_adrenal_gland - Val Loss: 0.1082, Dice: 0.8749
  Gallbladder - Val Loss: 0.0623, Dice: 0.9414
  Esophagus - Val Loss: 0.0736, Dice: 0.9152
  Stomach - Val Loss: 0.0315, Dice: 0.9734
  Left_kidney - Val Loss: 0.0228, Dice: 0.9765
Liver Validation Complete: Loss: 0.0298, Dice: 0.9815
Right_kidney Validation Complete: Loss: 0.0250, Dice: 0.9764
Spleen Validation Complete: Loss: 0.0243, Dice: 0.9806
Pancreas Validation Complete: Loss: 0.1471, Dice: 0.8444
Aorta Validation Complete: Loss: 0.0313, Dice: 0.9658
Ivc Validation Complete: Loss: 0.0579, Dice: 0.9410
Right_adrenal_gland Validation Complete: Loss: 0.1172, Dice: 0.8730
Left_adrenal_gland Validation Complete: Loss: 0.1018, Dice: 0.8835
Gallbladder Validation Complete: Loss: 0.0809, Dice: 0.9205
Esophagus Validation Complete: Loss: 0.0784, Dice: 0.9093
Stomach Validation Complete: Loss: 0.0357, Dice: 0.9673
Left_kidney Validation Complete: Loss: 0.0229, Dice: 0.9776
Time: 20250621-1113, train_Loss: 0.015446989853855373, train_accuracy : 0.9818090629830172
Epoch 23/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.06268423842891283
  Liver - Val Loss: 0.0298, Dice: 0.9815
  Right_kidney - Val Loss: 0.0250, Dice: 0.9764
  Spleen - Val Loss: 0.0243, Dice: 0.9806
  Pancreas - Val Loss: 0.1471, Dice: 0.8444
  Aorta - Val Loss: 0.0313, Dice: 0.9658
  Ivc - Val Loss: 0.0579, Dice: 0.9410
  Right_adrenal_gland - Val Loss: 0.1172, Dice: 0.8730
  Left_adrenal_gland - Val Loss: 0.1018, Dice: 0.8835
  Gallbladder - Val Loss: 0.0809, Dice: 0.9205
  Esophagus - Val Loss: 0.0784, Dice: 0.9093
  Stomach - Val Loss: 0.0357, Dice: 0.9673
  Left_kidney - Val Loss: 0.0229, Dice: 0.9776
Liver Validation Complete: Loss: 0.0294, Dice: 0.9822
Right_kidney Validation Complete: Loss: 0.0253, Dice: 0.9763
Spleen Validation Complete: Loss: 0.0235, Dice: 0.9818
Pancreas Validation Complete: Loss: 0.1077, Dice: 0.8846
Aorta Validation Complete: Loss: 0.0302, Dice: 0.9672
Ivc Validation Complete: Loss: 0.0468, Dice: 0.9514
Right_adrenal_gland Validation Complete: Loss: 0.1150, Dice: 0.8778
Left_adrenal_gland Validation Complete: Loss: 0.1081, Dice: 0.8838
Gallbladder Validation Complete: Loss: 0.0764, Dice: 0.9248
Esophagus Validation Complete: Loss: 0.0725, Dice: 0.9165
Stomach Validation Complete: Loss: 0.0328, Dice: 0.9717
Left_kidney Validation Complete: Loss: 0.0225, Dice: 0.9775
Time: 20250621-1202, train_Loss: 0.01516365195464916, train_accuracy : 0.9821338571967112
Epoch 24/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.0575190794237774
  Liver - Val Loss: 0.0294, Dice: 0.9822
  Right_kidney - Val Loss: 0.0253, Dice: 0.9763
  Spleen - Val Loss: 0.0235, Dice: 0.9818
  Pancreas - Val Loss: 0.1077, Dice: 0.8846
  Aorta - Val Loss: 0.0302, Dice: 0.9672
  Ivc - Val Loss: 0.0468, Dice: 0.9514
  Right_adrenal_gland - Val Loss: 0.1150, Dice: 0.8778
  Left_adrenal_gland - Val Loss: 0.1081, Dice: 0.8838
  Gallbladder - Val Loss: 0.0764, Dice: 0.9248
  Esophagus - Val Loss: 0.0725, Dice: 0.9165
  Stomach - Val Loss: 0.0328, Dice: 0.9717
  Left_kidney - Val Loss: 0.0225, Dice: 0.9775
Liver Validation Complete: Loss: 0.1230, Dice: 0.8995
Right_kidney Validation Complete: Loss: 0.0258, Dice: 0.9750
Spleen Validation Complete: Loss: 0.0434, Dice: 0.9559
Pancreas Validation Complete: Loss: 0.2110, Dice: 0.7538
Aorta Validation Complete: Loss: 0.0333, Dice: 0.9637
Ivc Validation Complete: Loss: 0.0654, Dice: 0.9279
Right_adrenal_gland Validation Complete: Loss: 0.1270, Dice: 0.8652
Left_adrenal_gland Validation Complete: Loss: 0.1309, Dice: 0.8510
Gallbladder Validation Complete: Loss: 0.0629, Dice: 0.9415
Esophagus Validation Complete: Loss: 0.0822, Dice: 0.9073
Stomach Validation Complete: Loss: 0.0316, Dice: 0.9726
Left_kidney Validation Complete: Loss: 0.0226, Dice: 0.9777
Time: 20250621-1251, train_Loss: 0.01381748765337938, train_accuracy : 0.9836898900100924
Epoch 25/100
Latest model saved successfully to ./work_dir1/MedSAM-ViT-B_organ_prompts_ten_MSFalse_oneneckFalse_biomedclip_20250620-170025/medsam_model_latest.pth
val loss: 0.07992549124476182
  Liver - Val Loss: 0.1230, Dice: 0.8995
  Right_kidney - Val Loss: 0.0258, Dice: 0.9750
  Spleen - Val Loss: 0.0434, Dice: 0.9559
  Pancreas - Val Loss: 0.2110, Dice: 0.7538
  Aorta - Val Loss: 0.0333, Dice: 0.9637
  Ivc - Val Loss: 0.0654, Dice: 0.9279
  Right_adrenal_gland - Val Loss: 0.1270, Dice: 0.8652
  Left_adrenal_gland - Val Loss: 0.1309, Dice: 0.8510
  Gallbladder - Val Loss: 0.0629, Dice: 0.9415
  Esophagus - Val Loss: 0.0822, Dice: 0.9073
  Stomach - Val Loss: 0.0316, Dice: 0.9726
  Left_kidney - Val Loss: 0.0226, Dice: 0.9777
