Clearing CUDA cache...
CUDA cache cleared.
Created directory: ./work_dir/MedSAM-ViT-B_MSFalse_oneneckFalse_use_clip_20250619-0311
[MedSAM] clip_variant: clip, clip_model_name: hf-hub:laion/CLIP-ViT-B-32-laion2B-s34B-b79K
[INFO] clip_variant: clip, tokenizer: laion/CLIP-ViT-B-32-laion2B-s34B-b79K
[OrganSliceDataset] organ: liver, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[liver]  cases: 40, slices: 2522
[OrganSliceDataset] organ: right_kidney, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[right_kidney]  cases: 40, slices: 1619
[OrganSliceDataset] organ: spleen, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[spleen]  cases: 40, slices: 1310
[OrganSliceDataset] organ: pancreas, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[pancreas]  cases: 40, slices: 1274
[OrganSliceDataset] organ: aorta, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[aorta]  cases: 40, slices: 3486
[OrganSliceDataset] organ: ivc, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[ivc]  cases: 40, slices: 3226
[OrganSliceDataset] organ: right_adrenal_gland, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[right_adrenal_gland]  cases: 40, slices: 449
[OrganSliceDataset] organ: left_adrenal_gland, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[left_adrenal_gland]  cases: 40, slices: 534
[OrganSliceDataset] organ: gallbladder, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[gallbladder]  cases: 40, slices: 686
[OrganSliceDataset] organ: esophagus, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[esophagus]  cases: 40, slices: 1074
[OrganSliceDataset] organ: stomach, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[stomach]  cases: 40, slices: 1557
[OrganSliceDataset] organ: left_kidney, tokenizer: CLIPTokenizerFast(name_or_path='laion/CLIP-ViT-B-32-laion2B-s34B-b79K', vocab_size=49408, model_max_length=77, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<|startoftext|>', 'eos_token': '<|endoftext|>', 'unk_token': '<|endoftext|>', 'pad_token': '<|endoftext|>'}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	49406: AddedToken("<|startoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),
	49407: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
[left_kidney]  cases: 40, slices: 1650
Checkpoint loaded successfully. Starting from epoch 1.
Using wandb
Liver Validation Complete: Loss: 0.1505, Dice: 0.8470
